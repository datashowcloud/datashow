<html>

<head>
    <meta charset="utf-8" />
    <title>Preparo Certificação em Português</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <script src="scripts/jquery.js"></script>
    <script src="scripts/bootstrap.js"></script>
    <link rel="stylesheet" type="text/css" href="style/bootstrap.css" />
    <link rel="stylesheet" href="style/font-awesome.min.css" />
    <script src="scripts/jsstore.js"></script>
    <script src="scripts/jsstore.worker.js"></script>
	<style>
	</style>
</head>

<body id="myMenu" style="background-color:#DCDCDC">

<div id="div01" style="display:'none';">
	<button class="btn btn-info" onclick="showPrevious('01');"> <i class="fa fa-backward"></i> Anterior</button>
	<button class="btn btn-default" onclick="showPoints('1');"><i class="fa fa-info"></i> Pontos</button>
	<button class="btn btn-info" onclick="showNext('01');">Próximo <i class="fa fa-forward"></i></button>
</div>

</body>

</html>

<script type="text/javascript">
var totalperguntas = 65;

function showPoints(qtdeResponses) {
	var qtdeCorretas = 0;
	var qtdeErradas = 0;
	var naorespondidas = 0;
	var erradas = '';
	var separador = '';
	var respondidas = '';
	var letra = '';
	var numero = '';
	var questBefore = '';
	var arraySelected = [];
	var questSelected = [];
	var gabarito = ['01a','02a','03a','04a','05a','06c','07d','08d','09d','10b','11d','12c','13b','14d','15c','16c','17a','18c','19c','20d','21d','22a','23ab','24a','25c','26b','27c','28b','29d','30d','31c','32a','33d','34d','35a','36a','37b','38d','39a','40c','41c','42a','43d','44a','45a','46c','47c','48d','49b','50b','51c','52a','53b','54b','55c','56c','57a','58d','59d','60d','61b','62b','63ab','64abc','65bd'];
	var checkboxes = document.querySelectorAll('input[type=checkbox]:checked');
		
	//soma quantidade corretas e incorretas
	for (var i = 0; i < checkboxes.length; i++) {
		if (checkboxes[i].value.substring(0,2) != questBefore && questBefore != '') {
			arraySelected.push(numero + letra);
			letra = checkboxes[i].value.substring(2,3);
			numero = checkboxes[i].value.substring(0,2);
		} else {
			letra = letra + checkboxes[i].value.substring(2,3);
			numero = checkboxes[i].value.substring(0,2);
		}

		if (checkboxes[i].value.substring(0,2) != questBefore) {
			questSelected.push(checkboxes[i].value.substring(0,2)); //somente o número das 2 primeiras posições, descarta a letra
		}
		questBefore = checkboxes[i].value.substring(0,2);
	}
	arraySelected.push(numero + letra);
	arraySelected = '[' + arraySelected + ']';
	questSelected = '[' + questSelected + ']';

	//totaliza corretas, erradas e não respondidas
	for (var index=0; index<gabarito.length; index++) {
		var numero = gabarito[index].substring(0,2);
		//não respondida
		if (arraySelected.indexOf(numero, 0) < '0') {
			naorespondidas = naorespondidas + 1;
		//respondida
		} else {
			//correta
			if (arraySelected.indexOf(gabarito[index], 0) >= 0) { 
				var posini = arraySelected.indexOf(gabarito[index], 0);
				var posfim = arraySelected.indexOf(',', posini);
				if (posfim <= 0) {
					posfim = arraySelected.indexOf(']', posini);
				}
				if (arraySelected.substring(posini, posfim) == gabarito[index]) {
					qtdeCorretas = parseInt(qtdeCorretas) + 1;
				} else {
					qtdeErradas = parseInt(qtdeErradas) + 1;
					erradas = erradas + separador + parseInt(index+1); separador = '; ';
				}
			} else { //errada
				qtdeErradas = parseInt(qtdeErradas) + 1;
				erradas = erradas + separador + parseInt(index+1); separador = '; ';
			}
		}
	}









	var array = [];
	var checkboxes = document.querySelectorAll('input[type=checkbox]:checked');
	for (var i = 0; i < checkboxes.length; i++) {
	  array.push(checkboxes[i].value);
	}
	array = '[' + array + ']';

	var valor = '';
	var responder = '';
	var separador = '';
	for (index=1; index<=totalperguntas; index++) {
		valor = '' + index;
		valor = valor.substring(0, 3)
		if (array.indexOf(valor, 0) <= '0') {
			responder = responder + separador + valor;
			separador = '; ';
		}
	}

	calculo = (qtdeCorretas*100) / totalperguntas;
	var resultado = '';
	if (calculo >= 70) {
		resultado = resultado + 'APROVADO \n' + calculo + '% de acerto é >= que 70%'
	} else {
		resultado = resultado + 'REPROVADO \n' + calculo + '% de acerto é < que 70%'
	}
	resultado = resultado + '\n\n' + qtdeCorretas + ' corretas';
	resultado = resultado + '\n' + qtdeErradas + ' erradas ' + erradas;
	resultado = resultado + '\n' + naorespondidas + ' não respondidas';
	resultado = resultado + '\n\nResponda: '  + responder;
	alert(resultado);

//	document.getElementById("formAdd").submit();
}

function showNext(numberQuestion) {
	questionNextPrevious = parseInt(numberQuestion) + 1;
	questionNextPrevious = '0' + questionNextPrevious;
	questionNextPrevious = questionNextPrevious.substring((questionNextPrevious.length-2),questionNextPrevious.length);
alert(document.getElementById('framemenu'));
	for (index=0; index<=totalperguntas; index++) {
		var formata = '0' + index;
		formata = formata.substring((formata.length-2),formata.length);
		if (parseInt(index) == parseInt(questionNextPrevious)) {
			if (document.getElementById('div' + formata) == null) {
				alert('Fim! Confira sua pontuação.');
				document.getElementById('div' + numberQuestion).style.display='block';
				break;
			} else {
				document.getElementById('div' + formata).style.display='block';
			}
		} else {
			document.getElementById('div' + formata).style.display='none';
		}
	}
}

function showPrevious(numberQuestion) {
	questionNextPrevious = parseInt(numberQuestion) - 1;
	questionNextPrevious = '0' + questionNextPrevious;
	questionNextPrevious = questionNextPrevious.substring((questionNextPrevious.length-2),questionNextPrevious.length);

	document.getElementById('div' + questionNextPrevious).style.display='block';
	document.getElementById('div' + numberQuestion).style.display='none';
}

function showResponse(numberQuestion, nameElement) {
	if (ckeckEmptyAnswers(numberQuestion) == '0') {
		alert('Responda a pergunta antes de ver a resposta');
		return;
	}
	if (document.getElementById(nameElement + numberQuestion).style.display == 'none') {
		document.getElementById(nameElement + numberQuestion).style.display='block';
	} else {
		document.getElementById(nameElement + numberQuestion).style.display='none';
	}
}

function ckeckEmptyAnswers(numberQuestion) {
	var array = [];
	var checkboxes = document.querySelectorAll('input[type=checkbox]:checked');
	for (var i = 0; i < checkboxes.length; i++) {
	  array.push(checkboxes[i].value);
	}
	array = '[' + array + ']';
	if (array.indexOf(numberQuestion, 0) <= '0') {
		return '0';
	} else {
		return '1';
	}
}
</script>
